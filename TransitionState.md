# 10. Transition State Search

## 10.1 Nudged Elastic Band

Here is an example input for HCN - HNC isomerization reaction

```
!B3LYP DEF2-SVP D4 NEB-TS FREQ

%NEB 
  NEB_END_XYZFILE "HNC.xyz"
  NEB_TS_XYZFILE  "TS.xyz"
  PREOPT_ENDS     TRUE
END

%GEOM
  CALC_HESS       TRUE
  RECALC_HESS     5
  MAXITER         50
END

%MAXCORE 4000

%PAL
  NPROCS 8
END

* XYZfile 0 1 HCN.xyz
```

Here are the geometries used

- `HCN.xyz`
```
3
HCN
C         -2.76788        0.86239        0.00000
N         -1.61084        0.87791        0.00000
H         -3.82622        0.84820        0.00000
```

- `HNC.xyz`
```
3
HNC
C         -2.76788        0.86239        0.00000
N         -1.61084        0.87791        0.00000
H         -0.53913        0.93704       -0.00000
```

- `TS.xyz` 
```
3
TS
C         -2.76788        0.86239        0.00000
N         -1.61084        0.87791        0.00000
H         -2.29372        1.98091       -0.00000
```

### Output
- Energy
```
---------------------------------------------------------------
                      PATH SUMMARY FOR NEB-TS             
---------------------------------------------------------------
All forces in Eh/Bohr. Global forces for TS.

Image     E(Eh)   dE(kcal/mol)  max(|Fp|)  RMS(Fp)
  0     -93.30152     0.00       0.00001   0.00001
  1     -93.26819    20.92       0.00177   0.00090
  2     -93.24438    35.85       0.00252   0.00147
  3     -93.22971    45.06       0.00867   0.00564
  4     -93.22535    47.80       0.00028   0.00015 <= CI
 TS     -93.22535    47.80       0.00007   0.00004 <= TS
  5     -93.23119    44.13       0.00452   0.00248
  6     -93.24124    37.82       0.00205   0.00118
  7     -93.25247    30.78       0.00104   0.00055
  8     -93.26687    21.75       0.00217   0.00096
  9     -93.27982    13.62       0.00011   0.00004
```
- Frequencies
```
-----------------------
VIBRATIONAL FREQUENCIES
-----------------------

Scaling factor for frequencies =  1.000000000  (already applied!)

   0:         0.00 cm**-1
   1:         0.00 cm**-1
   2:         0.00 cm**-1
   3:         0.00 cm**-1
   4:         0.00 cm**-1
   5:         0.00 cm**-1
   6:     -1130.57 cm**-1 ***imaginary mode***
   7:      2089.81 cm**-1
   8:      2621.95 cm**-1
```

## 10.2 OptTS

Following NEB, one can do a tight optimization of the TS structure

```
!B3LYP DEF2-SVP D4 OptTS FREQ TightSCF

* XYZfile 0 1 TS_NEB_NEB-TS_converged.xyz

%GEOM
  CALC_HESS       TRUE
  RECALC_HESS     5
  MAXITER         50
  CONVERGENCE     Tight
END

%MAXCORE 4000

%PAL
  NPROCS 8
END
```

- Frequencies
```
-----------------------
VIBRATIONAL FREQUENCIES
-----------------------

Scaling factor for frequencies =  1.000000000  (already applied!)

   0:         0.00 cm**-1
   1:         0.00 cm**-1
   2:         0.00 cm**-1
   3:         0.00 cm**-1
   4:         0.00 cm**-1
   5:         0.00 cm**-1
   6:     -1130.55 cm**-1 ***imaginary mode***
   7:      2089.82 cm**-1
   8:      2621.93 cm**-1
```

## 10.3 IRC

Finally, do an IRC to confirm if the TS is actually the one connecting the reactant and product. It is probably best to use loose convergence (which is the default) and if needed do optimization of the end points.

```
! B3LYP DEF2-SVP D4 TightSCF KDIIS SOSCF Freq IRC

* XYZfile 0 1 TS_opt_tight.xyz

%IRC

  MAXITER          200
  PRINTLEVEL       1
  DIRECTION        BOTH

  # Default, Loose Convergence
  TOLMAXG          2.e-3
  TOLRMSG          5.e-4

  Monitor_Internals 
    # Up to three internal coordinates can be defined
    # for which the values are printed during the IRC run.
    # Possible are (B)onds, (A)ngles, (D)ihedrals and (I)mpropers
    {B 0 2}
    {B 1 2} 
  END
END

%MAXCORE 4000

%PAL
  NPROCS 8
END
```

- Output
```
                      ***********************HURRAY********************
                      ***            THE IRC HAS CONVERGED          ***
                      *************************************************


---------------------------------------------------------------
                       IRC PATH SUMMARY              
---------------------------------------------------------------
All gradients are in Eh/Bohr.

Step        E(Eh)      dE(kcal/mol)  max(|G|)   RMS(G)  B(H  2,C  0) B(H  2,N  1)
   1       -93.279806   -34.174595    0.000785  0.000446      2.18         1.01   
   2       -93.279805   -34.173582    0.000951  0.000521      2.18         1.01   
   3       -93.279803   -34.172328    0.001513  0.000718      2.18         1.01   
   4       -93.279800   -34.170422    0.002627  0.001168      2.18         1.01   
   5       -93.279778   -34.156788    0.001369  0.000707      2.18         1.00   
   6       -93.279737   -34.131081    0.002025  0.000944      2.18         1.01   
   7       -93.279680   -34.095227    0.002801  0.001202      2.18         1.00   
   8       -93.279607   -34.049793    0.003243  0.001474      2.17         1.00   
   9       -93.279521   -33.995619    0.004156  0.001761      2.17         1.00   
  10       -93.279418   -33.931186    0.004459  0.002001      2.17         1.01   
  11       -93.279299   -33.856412    0.005059  0.002262      2.17         1.00   
  12       -93.279178   -33.780222    0.005151  0.002822      2.17         1.01   
  13       -93.279120   -33.743680    0.007392  0.003825      2.17         1.01   
  14       -93.278985   -33.659452    0.008139  0.004450      2.18         1.01   
  15       -93.278407   -33.296810    0.006538  0.003919      2.15         1.00   
  16       -93.277533   -32.747928    0.010599  0.004614      2.14         1.01   
  17       -93.276476   -32.084662    0.011184  0.005405      2.12         1.00   
  18       -93.275218   -31.295696    0.012866  0.006054      2.10         1.01   
  19       -93.273865   -30.446240    0.013774  0.006895      2.08         1.01   
  20       -93.272313   -29.472367    0.014495  0.007223      2.05         1.01   
  21       -93.270881   -28.573793    0.016112  0.009068      2.03         1.01   
  22       -93.269397   -27.642533    0.018289  0.008801      2.00         1.02   
  23       -93.265809   -25.391162    0.018013  0.009147      1.93         1.01   
  24       -93.261801   -22.875858    0.018339  0.009659      1.87         1.02   
  25       -93.257529   -20.195344    0.019097  0.009919      1.78         1.02   
  26       -93.253072   -17.398450    0.017590  0.010044      1.70         1.04   
  27       -93.248617   -14.602915    0.018988  0.009973      1.61         1.05   
  28       -93.244187   -11.823253    0.017893  0.009763      1.52         1.07   
  29       -93.239799   -9.069567    0.018345  0.009890      1.43         1.10   
  30       -93.235318   -6.257609    0.017541  0.010232      1.35         1.14   
  31       -93.231183   -3.662879    0.021862  0.010691      1.29         1.21   
  32       -93.227222   -1.177451    0.011878  0.006692      1.24         1.29   
  33       -93.225345    0.000000    0.000073  0.000037      1.20         1.40    <= TS
  34       -93.227300   -1.226616    0.015079  0.007918      1.17         1.51   
  35       -93.232002   -4.176795    0.031730  0.016148      1.13         1.59   
  36       -93.234317   -5.629613    0.027746  0.015141      1.12         1.62   
  37       -93.237755   -7.787365    0.027793  0.016342      1.11         1.67   
  38       -93.241671   -10.244471    0.033421  0.018169      1.11         1.71   
  39       -93.245781   -12.823328    0.032588  0.018849      1.10         1.75
  40       -93.250158   -15.570162    0.036300  0.019828      1.09         1.80   
  41       -93.254606   -18.361098    0.035146  0.020021      1.09         1.83   
  42       -93.259138   -21.205087    0.036485  0.020190      1.08         1.87   
  43       -93.263651   -24.036887    0.035174  0.020048      1.08         1.91   
  44       -93.268093   -26.824681    0.037757  0.019695      1.08         1.95   
  45       -93.272420   -29.539709    0.034202  0.019241      1.08         1.99   
  46       -93.276540   -32.124822    0.036724  0.018284      1.07         2.02   
  47       -93.280509   -34.615634    0.032835  0.017540      1.07         2.05   
  48       -93.284162   -36.908124    0.034326  0.016161      1.07         2.09   
  49       -93.287604   -39.067971    0.029755  0.015224      1.08         2.11   
  50       -93.290648   -40.978021    0.029999  0.013435      1.07         2.14   
  51       -93.293444   -42.732223    0.025281  0.012221      1.08         2.16   
  52       -93.295788   -44.203389    0.023821  0.010211      1.08         2.18   
  53       -93.297821   -45.478760    0.018877  0.008584      1.08         2.20   
  54       -93.299383   -46.458928    0.015593  0.006466      1.08         2.22   
  55       -93.300557   -47.196074    0.010375  0.004444      1.08         2.23   
  56       -93.301265   -47.639808    0.005625  0.002327      1.08         2.23   
  57       -93.301410   -47.731161    0.007640  0.003644      1.08         2.23   
  58       -93.301431   -47.744351    0.003431  0.002014      1.08         2.23   
  59       -93.301443   -47.751797    0.003146  0.001405      1.08         2.23   
  60       -93.301471   -47.769529    0.002460  0.001012      1.08         2.23   
  61       -93.301495   -47.784573    0.001826  0.000842      1.08         2.23   
  62       -93.301501   -47.788015    0.001621  0.000733      1.08         2.23   
  63       -93.301506   -47.791044    0.001425  0.000671      1.08         2.23   
  64       -93.301509   -47.792957    0.001278  0.000577      1.08         2.23   
  65       -93.301512   -47.794839    0.001125  0.000549      1.08         2.23   
  66       -93.301513   -47.795896    0.001019  0.000453      1.08         2.23 
```
