# 10. Transition State Search

## 10.1 Nudged Elastic Band

Here is an example input for HCN - HNC isomerization reaction

```
!B3LYP DEF2-SVP D4 NEB-TS FREQ

%NEB 
  NEB_END_XYZFILE "HNC.xyz"
  NEB_TS_XYZFILE  "TS.xyz"
  PREOPT_ENDS     TRUE
END

%GEOM
  CALC_HESS       TRUE
  RECALC_HESS     5
  MAXITER         50
END

%MAXCORE 4000

%PAL
  NPROCS 8
END

* XYZfile 0 1 HCN.xyz
```

Here are the geometries used

- `HCN.xyz`
```
3
HCN
C         -2.76788        0.86239        0.00000
N         -1.61084        0.87791        0.00000
H         -3.82622        0.84820        0.00000
```

- `HNC.xyz`
```
3
HNC
C         -2.76788        0.86239        0.00000
N         -1.61084        0.87791        0.00000
H         -0.53913        0.93704       -0.00000
```

- `TS.xyz` 
```
3
TS
C         -2.76788        0.86239        0.00000
N         -1.61084        0.87791        0.00000
H         -2.29372        1.98091       -0.00000
```

### Output
- Energy
```
---------------------------------------------------------------
                      PATH SUMMARY FOR NEB-TS             
---------------------------------------------------------------
All forces in Eh/Bohr. Global forces for TS.

Image     E(Eh)   dE(kcal/mol)  max(|Fp|)  RMS(Fp)
  0     -93.30152     0.00       0.00001   0.00001
  1     -93.26819    20.92       0.00177   0.00090
  2     -93.24438    35.85       0.00252   0.00147
  3     -93.22971    45.06       0.00867   0.00564
  4     -93.22535    47.80       0.00028   0.00015 <= CI
 TS     -93.22535    47.80       0.00007   0.00004 <= TS
  5     -93.23119    44.13       0.00452   0.00248
  6     -93.24124    37.82       0.00205   0.00118
  7     -93.25247    30.78       0.00104   0.00055
  8     -93.26687    21.75       0.00217   0.00096
  9     -93.27982    13.62       0.00011   0.00004
```
- Frequencies
```
-----------------------
VIBRATIONAL FREQUENCIES
-----------------------

Scaling factor for frequencies =  1.000000000  (already applied!)

   0:         0.00 cm**-1
   1:         0.00 cm**-1
   2:         0.00 cm**-1
   3:         0.00 cm**-1
   4:         0.00 cm**-1
   5:         0.00 cm**-1
   6:     -1130.57 cm**-1 ***imaginary mode***
   7:      2089.81 cm**-1
   8:      2621.95 cm**-1
```

## 10.2 OptTS

Following NEB, one can do a tight optimization of the TS structure

```
!B3LYP DEF2-SVP D4 OptTS FREQ TightSCF

* XYZfile 0 1 TS_NEB_NEB-TS_converged.xyz

%GEOM
  CALC_HESS       TRUE
  RECALC_HESS     5
  MAXITER         50
  CONVERGENCE     Tight
END

%MAXCORE 4000

%PAL
  NPROCS 8
END
```

- Frequencies
```
-----------------------
VIBRATIONAL FREQUENCIES
-----------------------

Scaling factor for frequencies =  1.000000000  (already applied!)

   0:         0.00 cm**-1
   1:         0.00 cm**-1
   2:         0.00 cm**-1
   3:         0.00 cm**-1
   4:         0.00 cm**-1
   5:         0.00 cm**-1
   6:     -1130.55 cm**-1 ***imaginary mode***
   7:      2089.82 cm**-1
   8:      2621.93 cm**-1
```

## 10.3 IRC

Finally, do an IRC to confirm if the TS is actually the one connecting the reactant and product. It is probably best to do a loose convergence and if needed do optimization of the end points.

```
! B3LYP DEF2-SVP D4 TightSCF KDIIS SOSCF Freq IRC

* XYZfile 0 1 TS_opt_tight.xyz

%IRC
  MAXITER          200
  PRINTLEVEL       1
  DIRECTION        BOTH
  # Normal Convergence, default is Loose Convergence
  TOLMAXG          3.e-4
  TOLRMSG          1.e-4
END

%MAXCORE 4000

%PAL
  NPROCS 8
END
```

- Output
```
                      ***********************HURRAY********************
                      ***            THE IRC HAS CONVERGED          ***
                      *************************************************


---------------------------------------------------------------
                       IRC PATH SUMMARY              
---------------------------------------------------------------
All gradients are in Eh/Bohr.

Step        E(Eh)      dE(kcal/mol)  max(|G|)   RMS(G) 
   1       -93.279817   -34.181385    0.000198  0.000098
   2       -93.279817   -34.181359    0.000207  0.000102
   3       -93.279817   -34.181330    0.000216  0.000106
   4       -93.279817   -34.181297    0.000215  0.000109
   5       -93.279817   -34.181263    0.000239  0.000117
   6       -93.279817   -34.181219    0.000228  0.000117
   7       -93.279817   -34.181180    0.000265  0.000128
   8       -93.279817   -34.181121    0.000244  0.000127
   9       -93.279817   -34.181074    0.000294  0.000141
  10       -93.279816   -34.180998    0.000261  0.000138
  11       -93.279816   -34.180942    0.000329  0.000157
  12       -93.279816   -34.180843    0.000281  0.000150
  13       -93.279816   -34.180774    0.000367  0.000174
  14       -93.279816   -34.180647    0.000305  0.000164
  15       -93.279816   -34.180563    0.000410  0.000193
  16       -93.279816   -34.180399    0.000332  0.000181
  17       -93.279815   -34.180294    0.000456  0.000215
  18       -93.279815   -34.180085    0.000363  0.000199
  19       -93.279815   -34.179954    0.000511  0.000240
  20       -93.279814   -34.179685    0.000398  0.000220
  21       -93.279814   -34.179523    0.000573  0.000268
  22       -93.279814   -34.179178    0.000438  0.000244
  23       -93.279813   -34.178974    0.000642  0.000300
  24       -93.279813   -34.178530    0.000483  0.000271
  25       -93.279812   -34.178274    0.000722  0.000336
  26       -93.279811   -34.177702    0.000534  0.000302
  27       -93.279811   -34.177374    0.000801  0.000375
  28       -93.279810   -34.176643    0.000594  0.000337
  29       -93.279809   -34.176149    0.000789  0.000394
  30       -93.279807   -34.175318    0.000662  0.000387
  31       -93.279806   -34.174595    0.000785  0.000446
  32       -93.279805   -34.173582    0.000951  0.000521
  33       -93.279803   -34.172328    0.001513  0.000718
  34       -93.279800   -34.170422    0.002627  0.001168
  35       -93.279778   -34.156788    0.001369  0.000707
  36       -93.279737   -34.131081    0.002025  0.000944
  37       -93.279680   -34.095227    0.002801  0.001202
  38       -93.279607   -34.049793    0.003243  0.001474
  39       -93.279521   -33.995619    0.004156  0.001761
  40       -93.279418   -33.931186    0.004459  0.002001
  41       -93.279299   -33.856412    0.005059  0.002262
  42       -93.279178   -33.780222    0.005151  0.002822
  43       -93.279120   -33.743680    0.007392  0.003825
  44       -93.278985   -33.659452    0.008139  0.004450
  45       -93.278407   -33.296810    0.006538  0.003919
  46       -93.277533   -32.747928    0.010599  0.004614
  47       -93.276476   -32.084662    0.011184  0.005405
  48       -93.275218   -31.295696    0.012866  0.006054
  49       -93.273865   -30.446240    0.013774  0.006895
  50       -93.272313   -29.472367    0.014495  0.007223
  51       -93.270881   -28.573793    0.016112  0.009068
  52       -93.269397   -27.642533    0.018289  0.008801
  53       -93.265809   -25.391162    0.018013  0.009147
  54       -93.261801   -22.875858    0.018339  0.009659
  55       -93.257529   -20.195344    0.019097  0.009919
  56       -93.253072   -17.398450    0.017590  0.010044
  57       -93.248617   -14.602915    0.018988  0.009973
  58       -93.244187   -11.823253    0.017893  0.009763
  59       -93.239799   -9.069567    0.018345  0.009890
  60       -93.235318   -6.257609    0.017541  0.010232
  61       -93.231183   -3.662879    0.021862  0.010691
  62       -93.227222   -1.177451    0.011878  0.006692
  63       -93.225345    0.000000    0.000073  0.000037 <= TS
  64       -93.227300   -1.226616    0.015079  0.007918
  65       -93.232002   -4.176795    0.031730  0.016148
  66       -93.234317   -5.629613    0.027746  0.015141
  67       -93.237755   -7.787365    0.027793  0.016342
  68       -93.241671   -10.244471    0.033421  0.018169
  69       -93.245781   -12.823328    0.032588  0.018849
  70       -93.250158   -15.570162    0.036300  0.019828
  71       -93.254606   -18.361098    0.035146  0.020021
  72       -93.259138   -21.205087    0.036485  0.020190
  73       -93.263651   -24.036887    0.035174  0.020048
  74       -93.268093   -26.824681    0.037757  0.019695
  75       -93.272420   -29.539709    0.034202  0.019241
  76       -93.276540   -32.124822    0.036724  0.018284
  77       -93.280509   -34.615634    0.032835  0.017540
  78       -93.284162   -36.908124    0.034326  0.016161
  79       -93.287604   -39.067971    0.029755  0.015224
  80       -93.290648   -40.978021    0.029999  0.013435
  81       -93.293444   -42.732223    0.025281  0.012221
  82       -93.295788   -44.203389    0.023821  0.010211
  83       -93.297821   -45.478760    0.018877  0.008584
  84       -93.299383   -46.458928    0.015593  0.006466
  85       -93.300557   -47.196074    0.010375  0.004444
  86       -93.301265   -47.639808    0.005625  0.002327
  87       -93.301410   -47.731161    0.007640  0.003644
  88       -93.301431   -47.744351    0.003431  0.002014
  89       -93.301443   -47.751797    0.003146  0.001405
  90       -93.301471   -47.769529    0.002460  0.001012
  91       -93.301495   -47.784573    0.001826  0.000842
  92       -93.301501   -47.788015    0.001621  0.000733
  93       -93.301506   -47.791044    0.001425  0.000671
  94       -93.301509   -47.792957    0.001278  0.000577
  95       -93.301512   -47.794839    0.001125  0.000549
  96       -93.301513   -47.795896    0.001019  0.000453
  97       -93.301515   -47.797218    0.000887  0.000475
  98       -93.301516   -47.797764    0.000813  0.000359
  99       -93.301518   -47.798643    0.000704  0.000406
 100       -93.301518   -47.798965    0.000648  0.000291
 101       -93.301519   -47.799474    0.000568  0.000306
 102       -93.301519   -47.799698    0.000521  0.000231
 103       -93.301520   -47.800049    0.000452  0.000267
 104       -93.301520   -47.800181    0.000417  0.000189
 105       -93.301520   -47.800384    0.000367  0.000197
 106       -93.301521   -47.800478    0.000336  0.000150
 107       -93.301521   -47.800622    0.000293  0.000176
 108       -93.301521   -47.800677    0.000269  0.000123
 109       -93.301521   -47.800759    0.000237  0.000128
 110       -93.301521   -47.800799    0.000217  0.000098
```
